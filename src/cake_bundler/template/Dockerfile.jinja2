# Auto-generated by cake-bundler at {{ date_string }}
#
# Note 1: Any modification to this file will be overwritten by the
# auto-generation process.
#
# Note 2: If you plan to build elsewhere, make sure you copy the entire project
# directory, not just this file.
#

FROM ros:galactic-ros-base-focal
RUN apt-get update
RUN apt-get install -y \
    python3-pip \
    ros-galactic-navigation2 \
    ros-galactic-nav2-bringup \
    ros-galactic-slam-toolbox
# Nasty backport (delete after upgrading to python 3.9)
RUN curl https://raw.githubusercontent.com/python/cpython/3.9/Lib/asyncio/events.py \
    --output /usr/lib/python3.8/asyncio/events.py
{% if local_crl -%}
COPY crl /crl
WORKDIR /crl
RUN pip3 install .
{% else -%}
RUN pip3 install git+https://github.com/CakeRobotics/crl
{% endif -%}
{% if pip_requirements -%}
RUN pip3 install {{ pip_requirements | join(' ') }}
{% endif -%}
COPY . /app
CMD ["python3", "-u", "/app/main.py"]
